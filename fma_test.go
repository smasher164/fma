// MIT License

// Copyright (c) 2018 Akhil Indurti

// Permission is hereby granted, free of charge, to any person obtaining
// a copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do so, subject to
// the following conditions:

// The above copyright notice and this permission notice shall be
// included in all copies or substantial portions of the Software.

// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

package fma

import (
	"math"
	"testing"
)

// Test cases generated Berkeley TestFloat-3e/testfloat_gen, a BSD 3-Clause licensed program.
// http://www.jhauser.us/arithmetic/TestFloat.html
// The following are a random sampling of 256 from at least 180,795,884,544.
//
// // ./testfloat_gen -seed 24227 -level 2 f64_mulAdd | head -n 256
var cases = []struct{ x, y, z, want uint64 }{
	{0x3A600000FFFFFFF0, 0x1FB7D1145C02D065, 0x3FE000010000007E, 0x3FE000010000007E},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000},
	{0xC0122FFD19D13A1F, 0x41E00FFFC0000000, 0x400E00000000003F, 0xC202422CCE0D16F2},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000001, 0x0000000000000001},
	{0xC00FFE1000000000, 0xBFDFFFFFC000000F, 0x40300005FFFFFFFF, 0x4031FFE6FC003E00},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000002, 0x0000000000000002},
	{0x37EFFFF7FE000000, 0x37F0000100000003, 0xC7FFFFFFFFDFEFFE, 0xC7FFFFFFFFDFEFFE},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000004, 0x0000000000000004},
	{0x680007FFFFFFF7FF, 0xFD6A6E84A1E4D0C8, 0xAD836F812C4529E5, 0xFFF0000000000000},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000008, 0x0000000000000008},
	{0x2E50000120000000, 0x46012B30A716C9EF, 0xC3CFFFBF7FFFFFFE, 0xC3CFFFBF7FFFFFFE},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000010, 0x0000000000000010},
	{0xBFCFFFFBFFFFFF80, 0x000010000000FFFE, 0x3FB087FFFFFFFFFF, 0x3FB087FFFFFFFFFF},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000020, 0x0000000000000020},
	{0xBF20001FFFFFFFDF, 0x41E7FFFFFFFFDFFE, 0xFFF2813FAC2600CC, 0xFFFA813FAC2600CC},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000040, 0x0000000000000040},
	{0x7FEA80AFBF1335BB, 0xC3400000000001FE, 0xC80000FBFFFFFFFE, 0xFFF0000000000000},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000080, 0x0000000000000080},
	{0x409FBF0000000000, 0xB80B2F730A498E98, 0xC7FFFFFFE001FFFF, 0xC7FFFFFFE001FFFF},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000100, 0x0000000000000100},
	{0xBFF1FFFFFFFFFDFE, 0xC2417FFFFFFFFFFF, 0xBE001FFFFFBFFFFF, 0x4243AFFFFFFFFDCD},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000200, 0x0000000000000200},
	{0xB420000000200002, 0xC7EFFFFFFFC0001F, 0x40200000000083FE, 0x40200000000083FE},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000400, 0x0000000000000400},
	{0xC80FFFFFFF80FFFF, 0x41D3FFFFFFFFF7FF, 0x3CA007F7FFFFFFFE, 0xC9F3FFFFFFB097FE},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000000800, 0x0000000000000800},
	{0xC7E58435956B2D20, 0xFFE00000010FFFFE, 0x7FEF800000000001, 0x7FF0000000000000},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000001000, 0x0000000000001000},
	{0x380559E9B91B4F12, 0xF110000000FFFFFB, 0xC1D000004000007F, 0xE92559E9BA70EDA7},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000002000, 0x0000000000002000},
	{0xC3C07FFFFFFFFEFF, 0x2FC6AEDE98522524, 0xB81007FFFFFFFF7F, 0xB81007FFFFFFFF7F},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000004000, 0x0000000000004000},
	{0x4EC00010007FFFFF, 0xC1DBBB282F030256, 0x41CFFFF000003FFF, 0xD0ABBB43EB090A99},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000008000, 0x0000000000008000},
	{0x381100003FFFFFFF, 0x6CE000200003FFFE, 0xB9207F7FFFFFFFFE, 0x650100224004BFFD},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000010000, 0x0000000000010000},
	{0xC054DB1F5904AF61, 0x3D20200000000002, 0x41CFFF7FFFFFFEFF, 0x41CFFF7FFFFFFEFF},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000020000, 0x0000000000020000},
	{0x37E8621B1475919C, 0xBA20000000002001, 0x37EF800008000000, 0x37EF800008000000},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000040000, 0x0000000000040000},
	{0xBBBFFFFF5FFFFFFE, 0x41C000004007FFFF, 0xC15C901DFE41CF2C, 0xC15C901DFE41CF2C},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000080000, 0x0000000000080000},
	{0x43D000000047FFFF, 0x380FFFFFFFFBFFEF, 0x3F9FFFFF0000003E, 0x3F9FFFFF0000003E},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000100000, 0x0000000000100000},
	{0xB947A1CFDB22C999, 0xB806433140232624, 0xBFD3FFFFEFFFFFFF, 0xBFD3FFFFEFFFFFFF},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000200000, 0x0000000000200000},
	{0x4B244985F34D547A, 0x7FD1FFFFFFFFEFFE, 0x41E830544F8065F7, 0x7FF0000000000000},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000400000, 0x0000000000400000},
	{0x0020000040001FFE, 0x403FFFFFFFF5FFFE, 0xDE400000000000DF, 0xDE400000000000DF},
	{0x0000000000000000, 0x0000000000000000, 0x0000000000800000, 0x0000000000800000},
	{0x3F0BF47621F86C18, 0xBFFFFFFE0000FFFE, 0xC1C10003FFFFFFFE, 0xC1C100040000037D},
	{0x0000000000000000, 0x0000000000000000, 0x0000000001000000, 0x0000000001000000},
	{0xD960000000410000, 0x4010121F2C69547A, 0x419FFFFFFFFFF001, 0xD980121F2CAA9E19},
	{0x0000000000000000, 0x0000000000000000, 0x0000000002000000, 0x0000000002000000},
	{0x902000000003FFF6, 0x800000007FFFFFEE, 0xC03E0000000001FF, 0xC03E0000000001FF},
	{0x0000000000000000, 0x0000000000000000, 0x0000000004000000, 0x0000000004000000},
	{0xEEDFFFFFFF7FFFFF, 0xC10E000002000000, 0xC4B1007FFFFFFFFF, 0x6FFE00000187FFFF},
	{0x0000000000000000, 0x0000000000000000, 0x0000000008000000, 0x0000000008000000},
	{0x4060000FFFFFFE00, 0xC084CD34529AF257, 0x52CDEEFB4866E094, 0x52CDEEFB4866E094},
	{0x0000000000000000, 0x0000000000000000, 0x0000000010000000, 0x0000000010000000},
	{0xC7FA82550B3F06E6, 0x7F900000FF000000, 0xC1D000000001FFFE, 0xFFF0000000000000},
	{0x0000000000000000, 0x0000000000000000, 0x0000000020000000, 0x0000000020000000},
	{0x4B2FFFFFFBFFEFFF, 0x3E60007FFFF7FFFF, 0x524FFFBFFFFFFFF6, 0x524FFFBFFFFFFFF6},
	{0x0000000000000000, 0x0000000000000000, 0x0000000040000000, 0x0000000040000000},
	{0xB7EFFC0FFFFFFFFF, 0x43EE2234EC52B0F8, 0xCA800000000007F8, 0xCA800000000007F8},
	{0x0000000000000000, 0x0000000000000000, 0x0000000080000000, 0x0000000080000000},
	{0x0FF000000FFF7FFE, 0x381022D7907EBDC1, 0x3C4FFC0000000100, 0x3C4FFC0000000100},
	{0x0000000000000000, 0x0000000000000000, 0x0000000100000000, 0x0000000100000000},
	{0x37F290D8DAD31C97, 0xC00FF7FFFFFFFEFE, 0x3800080000000000, 0xB80510694938CE74},
	{0x0000000000000000, 0x0000000000000000, 0x0000000200000000, 0x0000000200000000},
	{0xBFBFFF4000000000, 0xC1DFFFFFFFFFFFFF, 0xC02FFFFFFE007FFF, 0x41AFFF3FE0000001},
	{0x0000000000000000, 0x0000000000000000, 0x0000000400000000, 0x0000000400000000},
	{0x000000000000021E, 0xC0108000000001FF, 0x401F800000000200, 0x401F800000000200},
	{0x0000000000000000, 0x0000000000000000, 0x0000000800000000, 0x0000000800000000},
	{0x244FFFFF7FFFFBFE, 0x47F0001FFFFFFBFF, 0x802001003FFFFFFE, 0x2C50001FBFFF79FE},
	{0x0000000000000000, 0x0000000000000000, 0x0000001000000000, 0x0000001000000000},
	{0x43E092F440CC8231, 0xBFEFFFFBFFFFFFFA, 0x6DB8E34F4F48B9F7, 0x6DB8E34F4F48B9F7},
	{0x0000000000000000, 0x0000000000000000, 0x0000002000000000, 0x0000002000000000},
	{0xC1CFFFFFFFFFEF7E, 0x418FFFFFFC000FFF, 0xBFE00080FFFFFFFF, 0xC36FFFFFFBFFFF7D},
	{0x0000000000000000, 0x0000000000000000, 0x0000004000000000, 0x0000004000000000},
	{0xB80FFFFFFFE00400, 0xB815C7BB8EEB803F, 0x3FCC000080000000, 0x3FCC000080000000},
	{0x0000000000000000, 0x0000000000000000, 0x0000008000000000, 0x0000008000000000},
	{0xC4340D3E00FABDB5, 0x1A6FE08000000000, 0xC1F000000000FFFB, 0xC1F000000000FFFB},
	{0x0000000000000000, 0x0000000000000000, 0x0000010000000000, 0x0000010000000000},
	{0x41D20003FFFFFFFF, 0x41DFFBFFFFFFFFEE, 0x43F0000000000000, 0x43F23FB87FEFFFFF},
	{0x0000000000000000, 0x0000000000000000, 0x0000020000000000, 0x0000020000000000},
	{0x43C000100FFFFFFF, 0x3FCEE9704EC2A692, 0x405FFC0000001FFF, 0x439EE98F571C65A3},
	{0x0000000000000000, 0x0000000000000000, 0x0000040000000000, 0x0000040000000000},
	{0x3F2FFBF7FFFFFFFF, 0xC4777F08C2C4B070, 0x3FE0FFFEFFFFFFFF, 0xC3B77C1301EA2728},
	{0x0000000000000000, 0x0000000000000000, 0x0000080000000000, 0x0000080000000000},
	{0x41FFFFFFFFFFFFED, 0x401000000FFFFFF7, 0xB801FFFEFFFFFFFF, 0x422000000FFFFFED},
	{0x0000000000000000, 0x0000000000000000, 0x0000100000000000, 0x0000100000000000},
	{0xC020000000001EFF, 0x4644000001000000, 0x705003FFEFFFFFFE, 0x705003FFEFFFFFFE},
	{0x0000000000000000, 0x0000000000000000, 0x0000200000000000, 0x0000200000000000},
	{0x0010000001FFFF7F, 0xC3DFDFFFFFFFDFFF, 0xC1E0007EFFFFFFFF, 0xC1E0007EFFFFFFFF},
	{0x0000000000000000, 0x0000000000000000, 0x0000400000000000, 0x0000400000000000},
	{0xC0EFFFEFFFF7FFFF, 0x9ABE6ECE440B95FA, 0xBFB1FFFFFBFFFFFE, 0xBFB1FFFFFBFFFFFE},
	{0x0000000000000000, 0x0000000000000000, 0x0000800000000000, 0x0000800000000000},
	{0xC01000001000007E, 0xC3E1051533EA6A42, 0xFFF00000003BFFFF, 0xFFF80000003BFFFF},
	{0x0000000000000000, 0x0000000000000000, 0x0001000000000000, 0x0001000000000000},
	{0x47F0800000001FFF, 0x41EFFFFFFFBFF7FF, 0x403FFFDFFFFC0000, 0x49F07FFFFFDF1BDE},
	{0x0000000000000000, 0x0000000000000000, 0x0002000000000000, 0x0002000000000000},
	{0x3D4B936A1CE81C52, 0x3F9E4D820D12ED90, 0x00000200001FFFFE, 0x3CFA1CFE4492713F},
	{0x0000000000000000, 0x0000000000000000, 0x0004000000000000, 0x0004000000000000},
	{0x43ED0B6F0B7202F7, 0xF0B0080000000004, 0xA4EFDFFFFFDFFFFE, 0xF4AD19F4C2F7BC00},
	{0x0000000000000000, 0x0000000000000000, 0x0008000000000000, 0x0008000000000000},
	{0xC1F008001FFFFFFE, 0xC0DFFFFFFFFFF7F6, 0xB7C0001004000000, 0x42E008001FFFFBF7},
	{0x0000000000000000, 0x0000000000000000, 0x000C000000000000, 0x000C000000000000},
	{0x40207FFFFFFFFFFF, 0x6DAFF80003FFFFFF, 0xA440040000001FFF, 0x6DE07BE0020FFFFE},
	{0x0000000000000000, 0x0000000000000000, 0x000E000000000000, 0x000E000000000000},
	{0xBFC0007800000000, 0xC1E4B615059952A4, 0xC03ACE1E170E22CA, 0x41B4B6B04068DE8B},
	{0x0000000000000000, 0x0000000000000000, 0x000F000000000000, 0x000F000000000000},
	{0xC01A91F459B3B16D, 0x0AB8EAC4F3D7A2D6, 0x3E44C50931E0038A, 0x3E44C50931E0038A},
	{0x0000000000000000, 0x0000000000000000, 0x000F800000000000, 0x000F800000000000},
	{0x3FE0010000000FFF, 0xC3E0000002000010, 0xB817DBD0ADD317E3, 0xC3D001000200300F},
	{0x0000000000000000, 0x0000000000000000, 0x000FC00000000000, 0x000FC00000000000},
	{0x3CB0000003FFFFFF, 0xC34001FFF8000000, 0x381FFFFFFFFFD7FF, 0xC00001FFFC007FFD},
	{0x0000000000000000, 0x0000000000000000, 0x000FE00000000000, 0x000FE00000000000},
	{0x40000000207FFFFF, 0x7FFFFFFFFFFFBF7F, 0x37E0000020007FFF, 0x7FFFFFFFFFFFBF7F},
	{0x0000000000000000, 0x0000000000000000, 0x000FF00000000000, 0x000FF00000000000},
	{0xC480000000408000, 0xA09FFDFFFFFFFFFF, 0xFFF00000007FFFFE, 0xFFF80000007FFFFE},
	{0x0000000000000000, 0x0000000000000000, 0x000FF80000000000, 0x000FF80000000000},
	{0xBE1FFFFFFF000FFF, 0x7FEFFF8007FFFFFF, 0x4687625EB01B3B85, 0xFE1FFF80070013FE},
	{0x0000000000000000, 0x0000000000000000, 0x000FFC0000000000, 0x000FFC0000000000},
	{0xC1FFDFFFFFFDFFFF, 0x3DAF00003FFFFFFF, 0xC3C0007FFFFFFBFF, 0xC3C0007FFFFFFBFF},
	{0x0000000000000000, 0x0000000000000000, 0x000FFE0000000000, 0x000FFE0000000000},
	{0x3EAFFFFFFFFFF802, 0x326000200000FFFF, 0x3ECDF8007752B787, 0x3ECDF8007752B787},
	{0x0000000000000000, 0x0000000000000000, 0x000FFF0000000000, 0x000FFF0000000000},
	{0x41D000008000000E, 0xC3FFFFFFFFDFFFF7, 0xDEF00000800000FE, 0xDEF00000800000FE},
	{0x0000000000000000, 0x0000000000000000, 0x000FFF8000000000, 0x000FFF8000000000},
	{0xDADFFFFFDC000000, 0x43E1FFFB5E85A588, 0x41E00200000FFFFF, 0xDED1FFFB4A45AABE},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFC000000000, 0x000FFFC000000000},
	{0x800F22F515F2D593, 0x3B00007FFFFFFFF7, 0x3E0B5496C93F1DB6, 0x3E0B5496C93F1DB6},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFE000000000, 0x000FFFE000000000},
	{0x3FD000001FFF7FFE, 0xFFDFFFFFFF1FFFFE, 0x37F000FFFFFFFFFC, 0xFFC000001F8F7FFC},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFF000000000, 0x000FFFF000000000},
	{0x39FFFFFFFFFFE800, 0xC01FFFFFFFFFF7BF, 0x406FFFFFFFFF8006, 0x406FFFFFFFFF8006},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFF800000000, 0x000FFFF800000000},
	{0xC2001FF800000000, 0x7FFA8ED51F1206E0, 0xC1FC000001FFFFFF, 0x7FFA8ED51F1206E0},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFC00000000, 0x000FFFFC00000000},
	{0xC3C4258B518163B8, 0xBFC00000000007F7, 0xBB500000000000DF, 0x4394258B51816DBF},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFE00000000, 0x000FFFFE00000000},
	{0xBF707FFFFFFFFFF0, 0xB93000041FFFFFFE, 0xC1C7592437EE97E2, 0xC1C7592437EE97E2},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFF00000000, 0x000FFFFF00000000},
	{0x0DF0000000FFFF7F, 0x41D000007FFFFF7E, 0xBFCC6E8D659E4D60, 0xBFCC6E8D659E4D60},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFF80000000, 0x000FFFFF80000000},
	{0xBF605DD50836E397, 0x424FFFFC0000001F, 0x3FF39CB7D3DBCC1C, 0xC1C05DD2FBDF5CE1},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFC0000000, 0x000FFFFFC0000000},
	{0xC5900000040FFFFF, 0x3D1B81385EF84A47, 0x43D0FFFFFFFFFF7F, 0x43D0FFF91FB1E602},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFE0000000, 0x000FFFFFE0000000},
	{0xC39023FFFFFFFFFF, 0xC1D7FC5D4638372A, 0x0008FA15004C1955, 0x45783255181635A5},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFF0000000, 0x000FFFFFF0000000},
	{0x404F9FFFFFFFFFFF, 0x403BA1A785BFC1CA, 0x3FF00021FFFFFFFE, 0x409B52C297AE8284},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFF8000000, 0x000FFFFFF8000000},
	{0xC0200000FFDFFFFF, 0xC7F26F008BD60EB9, 0xBF500000000011FE, 0x48226F01B2A13974},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFC000000, 0x000FFFFFFC000000},
	{0x40DCFB7EE68DFCBF, 0x436FFFFFFF8001FF, 0xB43A10E0857B778E, 0x445CFB7EE61A1092},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFE000000, 0x000FFFFFFE000000},
	{0xC00FDFFFFEFFFFFE, 0xC019AC104FC6F761, 0x14D000005FFFFFFF, 0x403992643EA9CFE6},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFF000000, 0x000FFFFFFF000000},
	{0x43F00000007FF000, 0xFFE000007F000000, 0x41DFFFFFFEFFFFFF, 0xFFF0000000000000},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFF800000, 0x000FFFFFFF800000},
	{0x2B4B6F99EB8DC68F, 0xC397D7F26039B041, 0xBF9003FFFFFFFFFB, 0xBF9003FFFFFFFFFB},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFC00000, 0x000FFFFFFFC00000},
	{0x7E60000040000FFF, 0x4029DA5AD4EFCB6D, 0x37F000020000001E, 0x7E99DA5B3C595099},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFE00000, 0x000FFFFFFFE00000},
	{0xFFD917E731FD2616, 0x3FCFFFFFFEFFFFDF, 0x4010000080000FFF, 0xFFB917E7313466C3},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFF00000, 0x000FFFFFFFF00000},
	{0xC060000000DFFFFF, 0x40000000001F7FFE, 0xBE60400000008000, 0xC070000001079FFD},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFF80000, 0x000FFFFFFFF80000},
	{0x40780000007FFFFF, 0xC3FFFFE1FFFFFFFF, 0xC01FFFFFF0020000, 0xC487FFE9807FFF86},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFC0000, 0x000FFFFFFFFC0000},
	{0x38198DFE22D46B33, 0xBFF3FFFFF7FFFFFE, 0xBFE00001FFFFFFBF, 0xBFE00001FFFFFFBF},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFE0000, 0x000FFFFFFFFE0000},
	{0xB94D312B64D81765, 0x3F91134546D1F7B4, 0x41DFFFFFFFEFFC00, 0x41DFFFFFFFEFFC00},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFF0000, 0x000FFFFFFFFF0000},
	{0x382000001FFFFFC0, 0x3A4000200000003E, 0xBF28172AC8ABE532, 0xBF28172AC8ABE532},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFF8000, 0x000FFFFFFFFF8000},
	{0xFF7F372E320C99D2, 0x801DFFFFFFFFDFFF, 0x47F480CD1AC016E4, 0x47F480CD1AC016E4},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFC000, 0x000FFFFFFFFFC000},
	{0x3FE413E4F1DAEB3B, 0x275FF80000200000, 0xBFECEE526E30E56D, 0xBFECEE526E30E56D},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFE000, 0x000FFFFFFFFFE000},
	{0xBFDFFFFFFC000001, 0xA5C00000000001F7, 0xFFEFFFFFBFFFFC00, 0xFFEFFFFFBFFFFC00},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFF000, 0x000FFFFFFFFFF000},
	{0x3FD020007FFFFFFF, 0x3F90FDE6200C1C5F, 0xBFF073298B792452, 0xBFF06209A904E8EC},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFF800, 0x000FFFFFFFFFF800},
	{0xC100000008FFFFFF, 0xBF80000400000020, 0x3CDFFFFF9FFFFFFF, 0x409000040900025F},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFC00, 0x000FFFFFFFFFFC00},
	{0x360245A7AE7E955B, 0x3A5007FFEFFFFFFF, 0x480020E2618CEE28, 0x480020E2618CEE28},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFE00, 0x000FFFFFFFFFFE00},
	{0x38100FFFFFFFFFEF, 0xCE30000000FFFFFB, 0x001BFFFFFFFFFFFF, 0xC65010000100FFEA},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFF00, 0x000FFFFFFFFFFF00},
	{0x40474C8EE93534BA, 0x43FFFDFFFFFFFDFE, 0x763C00000007FFFF, 0x763C00000007FFFF},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFF80, 0x000FFFFFFFFFFF80},
	{0x8020000400002000, 0x40252257ED7E42FC, 0x43FFF3A2D1376478, 0x43FFF3A2D1376478},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFC0, 0x000FFFFFFFFFFFC0},
	{0xB1ADDB4ADF7E1695, 0xBF1C70AD5A8F4BF1, 0xC020000004000003, 0xC020000004000003},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFE0, 0x000FFFFFFFFFFFE0},
	{0x3FF21F3F197F9A48, 0x411FFFFC0000003E, 0x41F6922E2764B9B2, 0x41F692BF214B6670},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFF0, 0x000FFFFFFFFFFFF0},
	{0x403BFFFFFFFFFFE0, 0x41F1FFFFFFF7FFFE, 0xBFD9F83A22C6F0F4, 0x423F7FFFFFF197F8},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFF8, 0x000FFFFFFFFFFFF8},
	{0xC3473E10747ADC99, 0x3FFFFFFFFFFF8006, 0xBFC7FFFBFFFFFFFE, 0xC3573E10747A7FA5},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFFC, 0x000FFFFFFFFFFFFC},
	{0xC1C98279403ED336, 0x43E0000000F80000, 0xBF3338A7797A485F, 0xC5B9827941CA398D},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFFE, 0x000FFFFFFFFFFFFE},
	{0x400FFFFFF000001E, 0xC0068FDF91795918, 0xC3E8000000000000, 0xC3E8000000000000},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFFF, 0x000FFFFFFFFFFFFF},
	{0xBF6FFFFFC000001E, 0xBFB000000008000F, 0x403C100000000000, 0x403C100FFFFFE008},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFFD, 0x000FFFFFFFFFFFFD},
	{0xC01000000FFBFFFE, 0x380E000000001FFF, 0x40200FFFFFFFFFFC, 0x40200FFFFFFFFFFC},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFFB, 0x000FFFFFFFFFFFFB},
	{0x3F30F27923F1F9D4, 0x22A0000002001FFF, 0xC7F28591E5A9DC81, 0xC7F28591E5A9DC81},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFF7, 0x000FFFFFFFFFFFF7},
	{0xB7E0000200000000, 0xBF90000020800000, 0xB7EF800002000000, 0xB7EF3FFFF97DFFF0},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFEF, 0x000FFFFFFFFFFFEF},
	{0x521FFE0000002000, 0x3FFFFF8000001FFF, 0xC7E0000000000000, 0x522FFD8008003FFD},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFDF, 0x000FFFFFFFFFFFDF},
	{0xD5AFFFDFFFBFFFFE, 0x40307FFFFFFFFFDE, 0xC77FFFFFFFFFFFFE, 0xD5F07FEF7FDEFFDD},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFFBF, 0x000FFFFFFFFFFFBF},
	{0x80010000000000FF, 0x4010000000001000, 0x37EFF9FFFFFFFFFF, 0x37EFF9FFFFFFFFFF},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFF7F, 0x000FFFFFFFFFFF7F},
	{0xF1F0800000000001, 0xBFEFFFFFF8000000, 0xBFEFF77FFFFFFFFF, 0x71F07FFFFBE00001},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFEFF, 0x000FFFFFFFFFFEFF},
	{0x37E0000000000020, 0x8F740000000FFFFF, 0xBF0FFFFFFFFFEFFC, 0xBF0FFFFFFFFFEFFC},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFDFF, 0x000FFFFFFFFFFDFF},
	{0xC0E0000000000024, 0x3F80000003EFFFFE, 0x43400103FFFFFFFE, 0x43400103FFFFFF7E},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFFBFF, 0x000FFFFFFFFFFBFF},
	{0xC0B00080000000FE, 0xC007FFFF7FFFFFFF, 0x0F2FFF8000000003, 0x40C800BF7FFC017C},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFF7FF, 0x000FFFFFFFFFF7FF},
	{0x3E93FFFFFF800000, 0x3FEFBFFFFFFC0000, 0xC1B0080000000010, 0xC1B008000000000B},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFEFFF, 0x000FFFFFFFFFEFFF},
	{0xB81F8CEEB216EB17, 0x40000FFBFFFFFFFE, 0xB6B3FFFC00000000, 0xB82FAC73E58D4D78},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFDFFF, 0x000FFFFFFFFFDFFF},
	{0xBE3FF800000FFFFE, 0xC801FFFFFFFFFFF7, 0xBE0000000010FFFF, 0x4651FB800008FFF6},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFFBFFF, 0x000FFFFFFFFFBFFF},
	{0x43E7FFBFFFFFFFFE, 0xFFF0F109870AB7C3, 0xC01CAD7BDCE24C12, 0xFFF8F109870AB7C3},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFF7FFF, 0x000FFFFFFFFF7FFF},
	{0x3FBFFFFFE00007FE, 0x3FF0200000400000, 0x30900007FFFF0000, 0x3FC01FFFF0200407},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFEFFFF, 0x000FFFFFFFFEFFFF},
	{0xB80001FFFFFFFFFF, 0x480FFFFFFDFFFFFF, 0x3FFE9E7BA4C50CC5, 0xC0185C6114CE7CCC},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFDFFFF, 0x000FFFFFFFFDFFFF},
	{0x400018F23CBD52B3, 0xBC3020000000001E, 0x3FC000010000000E, 0x3FC000010000000E},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFFBFFFF, 0x000FFFFFFFFBFFFF},
	{0x1EB00000400001FF, 0x80B0000010020000, 0xC0191F114A87369D, 0xC0191F114A87369D},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFF7FFFF, 0x000FFFFFFFF7FFFF},
	{0x0A1FDFFFFFFFF800, 0x3FDFDFFFFFF7FFFF, 0xC21FFFFFFFD80000, 0xC21FFFFFFFD80000},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFEFFFFF, 0x000FFFFFFFEFFFFF},
	{0x380FFFFF7FFFFFEE, 0x40A0000000010FFE, 0x3FD0002000200000, 0x3FD0002000200000},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFDFFFFF, 0x000FFFFFFFDFFFFF},
	{0x514F3A3A6351CB07, 0xA98FFFF0000FFFFF, 0x8000007FFDFFFFFF, 0xBAEF3A2AC644367A},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFFBFFFFF, 0x000FFFFFFFBFFFFF},
	{0xB5800000000021FE, 0xC01000007FFFFFDF, 0x32DFD643F3D43430, 0x35A00000800022DC},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFF7FFFFF, 0x000FFFFFFF7FFFFF},
	{0x47CF807FFFFFFFFF, 0xC034515F96FEEADD, 0x3805BB98AEBD2687, 0xC814006B5E214B2D},
	{0x0000000000000000, 0x0000000000000000, 0x000FFFFFFEFFFFFF, 0x000FFFFFFEFFFFFF},
}

func feq(a, b float64) bool {
	if math.IsNaN(a) && math.IsNaN(b) {
		return true
	}
	return a == b
}

func TestFMA(t *testing.T) {
	for _, c := range cases {
		x := math.Float64frombits(c.x)
		y := math.Float64frombits(c.y)
		z := math.Float64frombits(c.z)
		want := math.Float64frombits(c.want)
		got := FMA_MUSL(x, y, z)
		if !feq(got, want) {
			t.Errorf("FMA_MUSL(%v,%v,%v) == %v; want %v", x, y, z, got, want)
		}
		got = FMA_BSD(x, y, z)
		if !feq(got, want) {
			t.Errorf("FMA_BSD(%v,%v,%v) == %v; want %v", x, y, z, got, want)
		}
	}
}
